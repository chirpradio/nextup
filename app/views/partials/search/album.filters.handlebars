<form id="filters" class="form-inline form-row pl-2" action="/music/search/album" method="get"> 
    <div class="form-group col-lg-2">
      <label class="" for="search">Album/artist name</label>
      <input class="form-control w-100" id="search" name="term" type="search" value="{{query.term}}" aria-label="search">
    </div>
    <div class="form-group col-lg-2 mt-1">
      <label class="" for="label">Label</label>
      <input class="form-control w-100" id="label" name="album[label]" type="search" value="{{query.album.label}}">
    </div>
    <div class="form-group col-lg-1 mt-1">
      <label class="" for="year">Year</label>
      <input class="form-control w-100" id="year" name="album[year]" type="number" value="{{query.album.year}}">
    </div>
    <div class="form-group col-lg-1 mt-1">
      <label for="rotation">Rotation</label>
      <select id="rotation" class="form-control w-100" name="album[rotation]">
        <option value="any">Any</option>
        <option value="heavy_rotation" {{isSelected query.album.rotation "heavy_rotation"}}>Heavy</option>
        <option value="light_rotation" {{isSelected query.album.rotation "light_rotation"}}>Light</option>
      </select>
    </div>
    <div class="form-group col-lg-1 mt-1">
      <label for="local">Local</label>
      <select id="local" class="form-control w-100" name="album[local]">
        <option value="any">Any</option>
        <option value="local_current" {{isSelected query.album.local "local_current"}}>Current</option>
        <option value="local_classic" {{isSelected query.album.local "local_classic"}}>Classic</option>
      </select>
    </div>
    <div class="form-group col-lg-1 mt-1 mr-1">    
      <label class="w-100">&nbsp;</label>
      <label class="badge badge-info ml-1 py-0" for="is_compilation">  
        <input class="form-control mr-1" id="is_compilation" name="album[is_compilation]" type="checkbox" value="true" {{isChecked query.album.is_compilation "true"}}>       
        Compilation        
      </label> 
    </div>
    <div class="form-group col-xl-2 mt-1">
      <label class="w-100">&nbsp;</label>
      <div class="flex-row">
        <button class="btn btn-primary" type="submit">Search</button>
        <a class="btn btn-link" href="/music/search/album">clear filters</a>
      </div>
    </div>
</form>

<script>
  const form = document.getElementById('filters');
  
  function removeNamesWithoutValues() {
    const inputs = form.querySelectorAll("input");
    for(const input of inputs) {
      if(input.value === "") {
        input.removeAttribute("name");
      }
    }
  }

  function onSubmit(event) {
    event.preventDefault();
    removeNamesWithoutValues();
    gtag('event', 'Search', {
      'event_category': 'Music', 
      'event_label': 'Album',
      'event_callback': function() {
        form.submit();
      }
    });
  }

  form.addEventListener('submit', onSubmit);
</script>